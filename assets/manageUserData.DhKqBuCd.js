import{d as u,h as c,g as m,e as h}from"./Hashing.dgYeNg-H.js";import{p as r,g as l,s as n}from"./json.BquTsvhR.js";const f=a=>r(l("accsUser-"+a)),U=(a,s)=>{let t=r(l("accsUser-"+a)),e=r(u(t.data,t.salt));if(c(s+t.salt)===e.password){console.log("wasa");let o=i();localStorage.setItem("accsToken",n({username:t.username,token:o,salt:t.salt})),localStorage.setItem("accsUser-"+a,n({...t,token:o})),window.location.replace("/ManageAccounts/Dashboard");return}return"Login failed"},k=(a,s)=>{let t=i(),e=m(s.length),o={password:c(s+e),customPass:[],Accounts:[{Platform:"New Platform",Usage:0,id:1,Accounts:[]}]},d=h(JSON.stringify(o),e);localStorage.setItem("accsUser-"+a,JSON.stringify({data:d,username:a,token:t,salt:e})),localStorage.setItem("accsToken",JSON.stringify({username:a,token:t,salt:e})),window.location.replace("/ManageAccounts/Dashboard")},w=a=>!!f(a),i=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),y=()=>{localStorage.removeItem("accsToken"),window.location.replace("/ManageAccounts/Login")};export{y as L,U as a,f as g,k as r,w as v};
