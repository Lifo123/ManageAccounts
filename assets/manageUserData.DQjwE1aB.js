import{p as r,g as c,d as u,h as l,s as n,a as h,e as m}from"./Hashing.CagDVYOK.js";const f=a=>r(c("accsUser-"+a)),S=(a,s)=>{let t=r(c("accsUser-"+a)),e=r(u(t.data,t.salt));if(l(s+t.salt)===e.password){console.log("wasa");let o=i();localStorage.setItem("accsToken",n({username:t.username,token:o,salt:t.salt})),localStorage.setItem("accsUser-"+a,n({...t,token:o})),window.location.replace("/ManageAccounts/Dashboard");return}return"Login failed"},U=(a,s)=>{let t=i(),e=h(s.length),o={password:l(s+e),customPass:[],Accounts:[{Platform:"New Platform",Usage:0,id:1,Accounts:[]}]},d=m(JSON.stringify(o),e);localStorage.setItem("accsUser-"+a,JSON.stringify({data:d,username:a,token:t,salt:e})),localStorage.setItem("accsToken",JSON.stringify({username:a,token:t,salt:e})),window.location.replace("/ManageAccounts/Dashboard")},k=a=>!!f(a),i=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),w=()=>{localStorage.removeItem("accsToken"),window.location.replace("/ManageAccounts/Login")};export{w as L,S as a,f as g,U as r,k as v};
