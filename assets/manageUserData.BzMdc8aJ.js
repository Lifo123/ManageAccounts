import{C as i,S as g}from"./index.BwKZQmqs.js";const S=(t=16)=>i.lib.WordArray.random(t).toString(),s=(t,e)=>g(t+e).toString(),n=t=>JSON.parse(localStorage.getItem("accsUser-"+t)),u=(t,e)=>{let a=n(t);if(s(e+a.salt)===a.password){let o=c();localStorage.setItem("accsToken",JSON.stringify({token:o,username:t})),localStorage.setItem("accsUser-"+t,JSON.stringify({...a,token:o})),window.location.replace("/ManageAccounts/Dashboard");return}return"Login failed"},m=(t,e)=>{let a=c(),r=S(e.length),o=s(e+r),l={username:t,salt:r,password:o,token:a,customPass:[],Accounts:[]};localStorage.setItem("accsUser-"+t,JSON.stringify(l)),localStorage.setItem("accsToken",JSON.stringify({token:a,username:t})),window.location.replace("/ManageAccounts/Dashboard")},h=t=>!!n(t),c=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),f=()=>{localStorage.removeItem("accsToken"),window.location.replace("/ManageAccounts/Login")};export{f as L,u as a,n as g,m as r,h as v};
